# Multivariate selection of VLQ events
- Author: Zhaoyuan "Maxwell" Cui
- Advisor: Prof. [Erich Varnes](http://w3.physics.arizona.edu/people/erich-varnes)
- Physics department, University of Arizona 

## Introduction
This study leverages the TMVA tool kit of ROOT data analysis framework to enhance the search of vector-like quark (VLQ). More about VLQ can be found in the following papers:
> C. Lee and R. N. Mohapatra, J. High Energy Phys. **2017**, 80, [arXiv:1611.05478 [hep-ph]](https://arxiv.org/abs/1611.05478v1)
>
> J. A. Aguilar-Saavedra, R. Benbrik, S. Heinemeyer, and M. Perez-Victoria, Phys. Rev. D **88**, 094010 (2013), [arXiv:1306.0572 [hep-ph]](https://arxiv.org/abs/1306.0572v3)

The goal of the study is to use the multivariate analysis method (Machine Learning) to develop a new way of searhcing VLQ.
Boosted Decision Tree (BDT) is used in this study. Background and signal raw data are generated by MC simulation. 
Raw data are provided by [Sarah Jones](http://w3.physics.arizona.edu/people/sarah-jones).

## Procedure
The procedure of the study contains two parts:
1. Data preparation
1. BDT training

### Data preparation
The raw data from the simulation contain lots of infromation that is not needed in the training. At the same time, some information that one is interested, for example, b-jet, is not explicitly included. Therefore, it's necessary to extract and recombine the infromation from the raw data. Training data are generated by the code in the file `gnrTree.C`. There are two specific modifications included (tick indicates done):
- [x] b-jet calculation
- [x] normalization of event weight


Variables that are included in training data (tick indicates in-use variables in training):
- [x] `mu`
- [x] `el_pt`
- [x] `mu_pt`
- [x] `jet_pt`
- [x] `met_met`
- [x] `met_phi`
- [x] `met_sumet`
- [x] `SSee`
- [x] `SSmm`
- [x] `Sem`
- [x] `eee`
- [x] `eem`
- [x] `emm`
- [x] `mmm`
- [x] `lep_pt`
- [x] `ht`
- [x] `bj`
- [x] `evWeight`
- [ ] `jet_mv2c20` used for b-jet calculation
- [ ] `weight_mc`  used for event weight normalization

### BDT Training
Since TMVA is a tool kit from ROOT, the language of TMVA is C/C++ and works like the usual ROOT operation.

*This version of the code is only a testing verson. Most of the parameters have not been adjusted yet. 
Some preliminary results are included.*

The verbose contains info that are useful. It can be found in here [`BDT_VLQ_data.log`](https://github.com/maxwellcui/VLQ_BDT/blob/Training/BDT_VLQ_data.log)

### Parameters in this training code
All parameters are in default value

- Number of trees: 800
- Max depth: 3
- Min node size 5%
- Number of grid point: 20
- Boost type: Ada boost

![Input variables](https://github.com/maxwellcui/VLQ_BDT/blob/master/variables_id_c1.png)
![Input variables](https://github.com/maxwellcui/VLQ_BDT/blob/master/variables_id_c2.png)
![Input variables](https://github.com/maxwellcui/VLQ_BDT/blob/master/variables_id_c3.png)
![mva_BDT](https://github.com/maxwellcui/VLQ_BDT/blob/master/mva_BDT.png)
![overtrain](https://github.com/maxwellcui/VLQ_BDT/blob/master/overtrain_BDT.png)
